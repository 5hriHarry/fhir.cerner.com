<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="Content-Language" content="en-us">
  <meta http-equiv="imagetoolbar" content="false">
  <title></title>
  <link href="../../css/reset.css" rel="stylesheet" type="text/css">
  <link href="../../css/documentation.css" media="screen" rel="stylesheet" type="text/css">
  <link href="../../css/pygments.css" media="screen" rel="stylesheet" type="text/css">
  <script src="../../js/jquery.js" type="text/javascript"></script>
  <script src="../../js/documentation.js" type="text/javascript"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-62403415-1', 'auto');
    ga('send', 'pageview');
  </script>
</head>


<body class="dstu2_api">
  <div id="header-wrapper">
  <div id="header">
    <div>
      <a class="logo" href="../../">Cerner Corporation</a>
      <ul class="nav">
        <li><a href="../" class="nav-dstu2-api">DSTU 2 API</a></li>
        <li><a href="../../dstu1/" class="nav-dstu1-api">DSTU 1 API</a></li>
        <li><a href="https://groups.google.com/d/forum/cerner-fhir-developers">Support</a></li>
      </ul>
    </div>
  </div>
<!-- #header -->
</div>
<!-- #header-wrapper -->


  <div class="sub-nav">
    <h2><a href="../">API</a></h2>
  </div>

  <div id="wrapper">
    <div class="content">
      <h1 id="authorization-server-client-documentation">Authorization Server Client Documentation</h1>
<hr>

<h3 id="introduction">Introduction</h3>
<p>The Cerner Authorization Server currently supports <a href="https://tools.ietf.org/html/rfc6749">OAuth 2.0</a> <a href="http://docs.smarthealthit.org/authorization/public/">SMART on FHIR</a> launch workflows. As a client, it will require interaction between the client (your client application), the user, the authorization server, a SMART Launch server and a FHIR resource server.</p>

<h3 id="registration">Registration</h3>
<p>In order for your client application to utilize any FHIR protected resources, your client application must first register. To do this please <a href="https://groups.google.com/forum/#!forum/cerner-fhir-developers">contact us</a> with the following fields, all fields are <strong>required</strong>.</p>

<ul>
  <li>Name - Application name, this should match what the name of the app will be in the app store</li>
  <li>Redirect/Callback URI</li>
  <li>Email address</li>
  <li>Logo URI - The logo will need to be a <a href="https://en.wikipedia.org/wiki/Scalable_Vector_Graphics">Scalable Vector Graphics</a> image</li>
  <li>SMART Launch URI</li>
</ul>

<p>Once approved, a <strong>client identifier</strong> will be provided for use with the Cerner Authorization Server. As a registered client, Cerner organizations may then ask for your client application to be enabled, which is necessary in order to gain access to their protected FHIR resources.</p>

<h3 id="supported-scopes">Supported Scopes</h3>
<p>The Cerner Authorization Server supports many, but not all, of the <a href="http://docs.smarthealthit.org/authorization/public/">SMART</a> or <a href="http://openid.net/specs/openid-connect-core-1_0.html#ScopeClaims">OAuth/OpenID Connect</a> scopes. The following scopes are <strong>supported</strong>.</p>

<ul>
  <li>online_access</li>
  <li>launch</li>
  <li>openid</li>
  <li>profile</li>
</ul>

<h3 id="requesting-an-authorization-code">Requesting an authorization code</h3>
<p>Cerner currently supports the <a href="http://docs.smarthealthit.org/authorization/public/">SMART</a> launch workflow from within an EHR, such as Cerner Millennium’s PowerChart. This allows for current context information (patient info, encounter info, user info, etc.) to be provided to the client application upon launching. Below is a flowchart of the EHR-initiated <a href="http://docs.smarthealthit.org/authorization/public/">SMART</a> launch workflow.</p>

<p><img src="http://www.websequencediagrams.com/cgi-bin/cdraw?lz=dGl0bGUgRUhSIEFwcCBMYXVuY2ggRmxvdwoKTm90ZSAgbGVmdCBvZiBFSFI6IFVzZXIgbAAgBWVzIGFwcApFSFItPj5BcHA6IFJlZGlyZWN0IHRvIGFwcDoAIgYAQQZyaWdoAEIFACMHcXVlc3QgYXV0aG9yaXphdGlvbgpBcHAtPj4AYwUAPwxlaHI6ACEIZQCBARRPbiBhcHByb3ZhbABzHHIAgRgHX3VyaT9jb2RlPTEyMyYuLi4AcwYAgVsFUE9TVCAvdG9rZW4AGgkAggIGAIF6DUNyZWF0ZSAAIwU6XG4ge1xuYWNjZXNzXwA2BT1zZWNyZXQtAEMFLXh5eiZcbnBhdGllbnQ9NDU2JlxuZXhwaXJlc19pbjogMzYwMFxuLi4uXG59Cn0AgksGAIJLBVsATgYAYQYgcmVzcG9uc2VdAIMSBwCCRA5BACUGAF8HIGRhdGFcbnZpYSBGSElSIEFQSQCBWgtHRVQgL2ZoaXIvUACBDwYvNDU2XG5BAIMBDDogQmVhcmVyIACBOxAAg2wFAIEaB3tyZXNvdXJjZVR5cGU6ICIASAciLCAiYmlydGhEYXRlIjogLi4ufQo&amp;s=default" alt="alt text" title="SMART launch diagram"></p>

<p>Once a launch context is received by your client application from the EHR, it must be sent to the authorization server so that an authorization code may be requested. To request an authorization code, to turn in for an access code, you will need to issue a <strong>GET</strong> request to the authorization server’s authorize endpoint, which is provided by the <a href="http://docs.smarthealthit.org/authorization/conformance-statement/">SMART</a> token and authorization extension. At this point the authorization server will redirect the user to authenticate if they are not already authenticated. Your client application should use the system’s browser for performing this exchange rather than an embedded browser. The <strong>GET</strong> request will <strong>require</strong> the following query parameters.</p>

<ul>
  <li>response_type</li>
  <li>client_id</li>
  <li>launch - Note: only required if using a <a href="http://docs.smarthealthit.org/authorization/public/">SMART</a> launch context</li>
  <li>scope - Note: launch <strong>must</strong> be one of the scopes if using a <a href="http://docs.smarthealthit.org/authorization/public/">SMART</a> launch context</li>
</ul>

<p>It is also <strong>recommended</strong> that your client application provides the following query parameters.</p>

<ul>
  <li>state - to prevent <a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)">cross-site request forgery attacks</a>
</li>
  <li>redirect_uri - note: The redirect_uri <strong>must</strong> match what was originally registered</li>
</ul>

<p><code>
https://authorization.stagingcerner.com/realms/{TENANT_ID}/protocols/smart/authorize?response_type=code&amp;client_id={YOUR_CLIENT_ID}&amp;state=12345&amp;redirect_uri=https%3A%2F%2Ftest.com%2Fcb
</code></p>

<p>If the user does not currently have an active session, the Authorization Server will redirect the user to the identity provider for the client organization in order to authenticate.</p>

<p>If successful, the authorization server will redirect the user-agent back to your client applications redirect_uri with a <strong>code</strong> query parameter. This is the authorization code that can be exchanged for an access token.</p>

<p><code>
https://test.com/cb?code=1234-567890ab-cdef
</code></p>

<p>Note: Using embedded browsers prevents single sign-on and authentication may fail for certain organizations who implement third party authentication systems.</p>

<h3 id="requesting-an-access-token">Requesting an access token</h3>
<p>Once an authorization code has been acquired, a back-channel <strong>POST</strong> to the authorization server’s token endpoint can be made to request an access token. Following the <a href="https://tools.ietf.org/html/rfc6749">OAuth 2.0</a> spec, the authorization server accepts a content type of <strong>application/x-www-form-urlencoded</strong> from your client application with the following information.</p>

<ul>
  <li>grant_type</li>
  <li>code</li>
  <li>client_id</li>
  <li>redirect_uri (only if provided when the authorization code was requested)</li>
</ul>

<p><code>
https://authorization.stagingcerner.com/realms/{TENANT_ID}/protocols/smart/token
</code></p>

<p><code>
grant_type=authorization_code&amp;code={AUTHORIZATION_CODE}&amp;client_id={YOUR_CLIENT_ID}&amp;redirect_uri={YOUR CALLBACK URI}
</code></p>

<p>If successful, the authorization server will return a <strong>200 OK</strong> response with a content-type of <a href="http://json.org/"><strong>application/json</strong></a> similar to the example below.</p>

<p><code>
{
   "access_token":"eyJraWQiOiIyMDE1LTA1LTE1VDE4OjI2OjUxLjM0NiIsInR5cCI6IkpXVCIsImFsZyI6IkVTMjU2In0.eyJzdWIiOiJLTDAyODA2NSIsInVybjpjb206Y2VybmVyOmF1dGhvcml6YXRpb24uY2xhaW1zIjp7InZlciI6IjEuMCIsInRudCI6IjhlMzNhZTNkLTQ4NzItNGQyZi1hMDU5LTVmMjMwN2ZjYmYzYiJ9LCJhenAiOiIyIiwiaXNzIjoiaHR0cDpcL1wvbG9jYWxob3N0OjgwODBcL2F1dGhvcml6YXRpb25cLzhlMzNhZTNkLTQ4NzItNGQyZi1hMDU5LTVmMjMwN2ZjYmYzYlwvdG9rZW4iLCJleHAiOjE0MzE3MTUxNDcsImlhdCI6MTQzMTcxNDU0NywianRpIjoiZmIzZDMwOGQtZmQ0Yy00MTk5LTlmZDQtZTU2ZmEwM2Y3ZTViIn0.Fv_6-LtIFzvf7DHleH-rXsjnaEMFgTHRyok4vJ8hkml5FQtnKejNSwECvqdex7hz6VyclcMy67D_bcafNZjNb",
   "token_type":"Bearer",
   "expires_in":600,
   "refresh_token":"1234-567890ab-cdef"
}
</code></p>

<p>The <a href="https://tools.ietf.org/html/rfc6750">bearer access token</a> returned from the authorization server is a <a href="https://tools.ietf.org/html//rfc7519">JSON Web Token (JWT)</a>. The JWT is what you provide to the protected FHIR resource. If a refresh token was also requested, it will be returned as well. Access tokens are good for 10 minutes and it is recommended refreshing it before use if less than 5 minutes remain before it expires.</p>

<h3 id="openid-connect">OpenID Connect</h3>
<p>If the scopes “openid” and “profile” were originally provided, an <a href="http://openid.net/connect/">OpenID Connect</a> id_token will be included per the <a href="http://docs.smarthealthit.org/authorization/public/">SMART</a> specification that includes the user’s FHIR resource URL (userfhirurl) as the “profile” claim.</p>

<p><code>
{ 
  "access_token" : "18adCadfj_lj13S3ada8.41jVCo_dgalL",
  "encounter" : "91731344",
  "patient" : "121341578",
  "id_token" : "eyAiYWxnIjoibm9uZSIKfQ==.ewogICJpc3MiOiAiaHR0cHM6Ly9hdXRob3JpemF0aW9uLmRldmNlcm5lci5jb20vb2F1dGgyIiwKICAic3ViIjogIm1yNTE0QGNlcm5lci5jb20iLAogICJhdWQiOiAiY2xpZW50X2FwcCIsCiAgIm5vbmNlIjogIm4tMFM2X1d6QTJNaiIsCiAgImV4cCI6IDEzMTEyODE5NzAsCiAgImlhdCI6IDEzMTEyODA5NzAsCiAgInByb2ZpbGUiOiJodHRwczovL2V4YW1wbGUuY29tLzEyMzQiCn0="
}
</code></p>

<p>Additionally, the claims specified in the launch resolution response will be included in the custom claims of the authorization token defined by Cerner.</p>

<p><code>
"urn:com:cerner:authorization:claims" : 
{ 
    "azs" : [ 
        "test-scope1",
        "test-scope2" ],
      "encounter" : "91731344",
      "patient" : "121341578",
      "ppr":"100251",
      "tnt" : "8e33ae3d-4872-4d2f-a059-5f2307fcbf3b",
      "ver" : "1.0"
    }
</code></p>

<h3 id="using-an-access-token">Using an access token</h3>
<p>In order to use an access token, your client application needs to provide the access token received from the authorization server to the FHIR protected resource. The following is a non-normative example of the usage of the token to access a protected RESTful web service on a resource server.  It will need to be added as an authorization HTTP header.</p>

<p><code>
Authorization: Bearer {ACCESS_TOKEN}
</code></p>

<p>If the access token is valid, and your application is authorized, the FHIR resource server will allow your client application to access its protected resources.</p>

<h3 id="using-a-refresh-token">Using a Refresh Token</h3>
<p>The authorization server has support for <strong>online access</strong> refresh tokens. Refresh tokens <strong>must</strong> be used in conjunction with the <strong>online_access</strong> scope. In order to use a refresh token, the user’s session <strong>must</strong> remain active. To request a refresh token, <strong>online_access</strong> must be added to the scope query parameter when requesting an authorization code. If this scope is not added, a refresh token will not be returned. Following the <a href="https://tools.ietf.org/html/rfc6749">OAuth 2.0</a> spec , the authorization server accepts a content type of <strong>application/x-www-form-urlencoded</strong> <strong>POST</strong> from your client application with the following information.</p>

<ul>
  <li>grant_type</li>
  <li>refresh_token</li>
</ul>

<p><code>
grant_type=refresh_token&amp;refresh_token={REFRESH_TOKEN}
</code></p>

<p>If successful, the authorization server will return a <strong>200 OK</strong> response with a content-type of <a href="http://json.org/"><strong>application/json</strong></a> similar to the example below.</p>

<p><code>
{
   "access_token":"eyJraWQiOiIyMDE1LTA1LTE1VDE4OjI2OjUxLjM0NiIsInR5cCI6IkpXVCIsImFsZyI6IkVTMjU2In0.eyJzdWIiOiJLTDAyODA2NSIsInVybjpjb206Y2VybmVyOmF1dGhvcml6YXRpb24uY2xhaW1zIjp7InZlciI6IjEuMCIsInRudCI6IjhlMzNhZTNkLTQ4NzItNGQyZi1hMDU5LTVmMjMwN2ZjYmYzYiJ9LCJhenAiOiIyIiwiaXNzIjoiaHR0cDpcL1wvbG9jYWxob3N0OjgwODBcL2F1dGhvcml6YXRpb25cLzhlMzNhZTNkLTQ4NzItNGQyZi1hMDU5LTVmMjMwN2ZjYmYzYlwvdG9rZW4iLCJleHAiOjE0MzE3MTUxNDcsImlhdCI6MTQzMTcxNDU0NywianRpIjoiZmIzZDMwOGQtZmQ0Yy00MTk5LTlmZDQtZTU2ZmEwM2Y3ZTViIn0.Fv_6-LtIFzvf7DHleH-rXsjnaEMFgTHRyok4vJ8hkml5FQtnKejNSwECvqdex7hz6VyclcMy67D_bcafNZjNb",
   "token_type":"Bearer",
   "expires_in":600
}
</code></p>

<p>The refresh token issued is good while the user’s session is still valid and can be used over and over again until the user’s session is no longer valid or the refresh token has been revoked due to being compromised.</p>


    </div>

    <div id="js-sidebar" class="sidebar-shell">
    <div class="js-toggle-list sidebar-module expandable">
        <ul>
            <li class="js-topic">
                <h3>
<a href="#" class="js-expand-btn collapsed arrow-btn" data-proofer-ignore></a><a href="../">Overview</a>
</h3>
            </li>
            <li class="js-topic">
                <h3>
<a href="#" class="js-expand-btn collapsed arrow-btn" data-proofer-ignore></a><a href=".">Authorization</a>
</h3>
            </li>
            <li class="js-topic">
                <h3>
<a href="#" class="js-expand-btn collapsed arrow-btn" data-proofer-ignore></a><a href="../conformance/">Conformance Metadata</a>
</h3>
            </li>
            <li class="js-topic">
                <h3>
<a href="#" class="js-expand-btn collapsed arrow-btn" data-proofer-ignore></a><a href="../allergy-intolerance/">AllergyIntolerance</a>
</h3>
            </li>
            <li class="js-topic">
                <h3>
<a href="#" class="js-expand-btn collapsed arrow-btn" data-proofer-ignore></a><a href="../condition/">Condition</a>
</h3>
            </li>
            <li class="js-topic">
                <h3>
<a href="#" class="js-expand-btn collapsed arrow-btn" data-proofer-ignore></a><a href="../diagnostic-report/">DiagnosticReport</a>
</h3>
            </li>
            <li class="js-topic">
                <h3>
<a href="#" class="js-expand-btn collapsed arrow-btn" data-proofer-ignore></a><a href="../encounter/">Encounter</a>
</h3>
            </li>
            <li class="js-topic">
                <h3>
<a href="#" class="js-expand-btn collapsed arrow-btn" data-proofer-ignore></a><a href="../immunization/">Immunization</a>
</h3>
            </li>
            <li class="js-topic">
                <h3>
<a href="#" class="js-expand-btn collapsed arrow-btn" data-proofer-ignore></a><a href="../medication-prescription/">MedicationPrescription</a>
</h3>
            </li>
            <li class="js-topic">
                <h3>
<a href="#" class="js-expand-btn collapsed arrow-btn" data-proofer-ignore></a><a href="../observation/">Observation</a>
</h3>
            </li>
            <li class="js-topic">
                <h3>
<a href="#" class="js-expand-btn collapsed arrow-btn" data-proofer-ignore></a><a href="../patient/">Patient</a>
</h3>
            </li>
        </ul>
    </div> <!-- /sidebar-module -->
    <div class="sidebar-module notice">
        <p>This website is a <a href="https://github.com/cerner/fhir.cerner.com" target="_blank">public GitHub repository</a>. Please help us by forking the project and adding to it.</p>
    </div>
</div>
<!-- /sidebar-shell -->

  </div>
<!-- #wrapper -->

    <div id="footer">
    <div class="lower_footer">
      <ul class="footer-cell">
        <li><a href="https://groups.google.com/d/forum/cerner-fhir-developers">Contact</a></li>
      </ul>

      <ul class="footer-cell">
        <li><a href="http://engineering.cerner.com/">Blog</a></li>
        <li><a href="https://www.cerner.com/About_Cerner/">About</a></li>
      </ul>
    </div>

    <div class="wrapper">
      <p>Design © <span class="js-year"></span> Copyright <span class="js-year"></span> Cerner Corporation </p>
    </div>

  </div>
<!-- /#footer -->

</body>
</html>
